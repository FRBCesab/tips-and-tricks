{
  "hash": "33c4fd4ad580f1a5d9bdfbf617a4a7ee",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Windows and the HOME directory\"\nauthor: \"Nicolas Casajus\"\ndate: \"2024-03-11\"\ncategories: [r, configuration, home, windows]\nimage: \"logo-r.png\"\ntoc: true\n---\n\n::: {.callout-important}\n## Windows-only\n\nThis post only concerns Windows users.\n:::\n\n\n\n## Context\n\n\nIn common operating systems, there is an important directory: the `HOME` directory (also known as the _User's home directory_). This directory contains the user's main folders (`Desktop/`, `Documents/`, `Pictures/`, etc.) but it can also be used by software to store user's configuration files (`ssh`, `bash`, `zsh`, etc.). \n\n::: {.callout-note}\n## Home vs. working directory\n\nThe _working directory_ is the directory from which {{< fa brands r-project >}} was launched. The function `getwd()` can be run to find this directory. This directory changes between projects. The _home directory_ is user specific and the symbol `~` is often used to refer to this `HOME` directory.\n:::\n\n{{< fa brands r-project >}} also uses this `HOME` directory to store two configuration files: the `.Renviron` and `.Rprofile` files (run `?Startup` to learn more about these files).\n\nOn Unix systems ({{< fa brands apple >}} and {{< fa brands ubuntu >}}), the `HOME` directory is `/home/username` (or `/Users/username` on Apple computers).\n\nOn Windows {{< fa brands windows >}}, depending on whether you use RStudio IDE (and therefore `Rgui.exe`) or {{< fa brands r-project >}} in a terminal (and therefore `Rterm.exe`), the value of this `HOME` directory can be different:\n\n- `C:/Users/username` on a terminal\n- `C:/Users/username/Documents` on RStudio IDE\n\nAnd the behavior of various {{< fa brands r-project >}} functions is inconsistent. For instance:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npath.expand(\"~\")\n## C:/Users/username/Documents\n\nnormalizePath(\"~\")\n## C:\\\\Users\\\\username\\\\Documents\n\nfs::path_home()\n## C:/Users/username\n```\n:::\n\n\n\n## Changing HOME directory\n\n\n::: {.callout-important}\n## Danger\n\n**Do not follow this tip if you are several users on the same computer.**\n:::\n\n\nHere we will resolve the discrepancy between these two different directories by using `C:/Users/username` everywhere (like in Unix systems).\n\nAs mentioned in the [R for Windows FAQ](https://cran.r-project.org/bin/windows/base/rw-FAQ.html#What-are-HOME-and-working-directories_003f) (section 2.13), we can modify this `HOME` directory at the system level by setting the environment variable `R_USER`.\n\nThis environment variable can be modified by creating a `.Renviron.site` file in the directory `C:/Program Files/R/R-X.X.X/etc/` (where `R-X.X.X` is the version of {{< fa brands r-project >}}). This file is used to store environment variables at the system level (so for all users).\n\n**N.B.** You need to have permission to create/edit this file.\n\n\nProceed as follow if the `.Renviron.site` file does not exist in `C:/Program Files/R/R-X.X.X/etc/`:\n\n- In `C:/Users/username/Desktop/`, create an empty file `.Renviron.site`.\n- Open this file and add this line: `R_USER='C:/Users/username'` (replace `username` by your Windows user name).\n- Save the file.\n- Copy this `.Renviron.site` file in `C:/Program Files/R/R-X.X.X/etc/`.\n\nProceed as follow if the `.Renviron.site` file already exists in `C:/Program Files/R/R-X.X.X/etc/`:\n\n- Open the `.Renviron.site` file in `C:/Program Files/R/R-X.X.X/etc/` and add this line: `R_USER='C:/Users/username'` (replace `username` by your Windows user name).\n- Save the file.\n\n\nAfter restarting {{< fa brands r-project >}}, run these lines:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSys.getenv(\"R_USER\")\n## C:/Users/username\n\npath.expand(\"~\")\n## C:/Users/username\n\nnormalizePath(\"~\")\n## C:\\\\Users\\\\username\n\nfs::path_home()\n## C:/Users/username\n```\n:::\n\n\nFrom now you should have the same outputs on RStudio IDE and on a Terminal.\n\n\n::: {.callout-important}\n## This is a temporary fix\n\nYou will need to repeat this tip each time you reinstall/upgrade {{< fa brands r-project >}}.\n:::\n\n\n## Edit (2024/03/12)\n\nWith some {{< fa brands r-project >}} functions, this tip is not enough. For instance, the functions `utils::file.edit(\"~/.Renviron\")`, `utils::file.edit(\"~/.Rprofile\")`, `usethis::edit_r_environ()`, `usethis::edit_r_profile()` do not recognized the new `HOME` directory.\n\nTo fix this issue, we need to define the `R_USER` environment variable at the Windows {{< fa brands windows >}} level.\n\nProceed as follow:\n\n- In the Windows search bar, type `variables` and open **Modify system environment variables**.\n- At the bottom, click on **Environment variables...**\n- In the section **System variable**, add a **new entry** and set:\n  - Name: `R_USER`\n  - Value: `C:\\Users\\username` (replace `username` by your Windows user name)\n\nAfter restarting {{< fa brands r-project >}}, the `HOME` directory should always point to `C:/Users/username`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSys.getenv(\"R_USER\")\n## C:/Users/username\n\npath.expand(\"~\")\n## C:/Users/username\n\nnormalizePath(\"~\")\n## C:\\\\Users\\\\username\n\nfs::path_home()\n## C:/Users/username\n```\n:::\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}